(in-package :aaf)

;;;
;;;  Utils
;;;

(defparameter *my-gensym-counter* 0)

(defun make-numbered-arg (&rest nums)
  (intern (format nil "Z狺铛眢┅ㄤ彐躅睐珏铙ī磲脲铛礅弪邃狎ㄩ钽睐珏铙憝泔躅翦颡┅换换渺狍箝汜乞犴鬻矧蔑铙趄蹉糸镱换ㄤ彐躅泔铙趄蹉舡汜铒铋汜飙徭ㄥ螬戾è疳轵磲疸犷＇ン弭疳轵弩┅ㄡ蜱躅轱瞠弩┅磲脲後狎珞蝈盹鲥殒灬礅溽皓礤礅弪疳轵呼弩＇箝黹灬颦疳轵蟓皓ē箦舡疳轵狎珞┅┅ㄤ彐躅ン弭疳轵ㄥ戾疳轵螬ㄤ镬轶ㄡ濠ㄤ镬轶ㄢ濠躅戾篌ㄥ聃犰猢瘐箬扉篝猢疳轵螬┅疳轵螬ㄤ彐躅泔铙趄蹉舡篝徕戾徭ㄥ狨í睐珏铙憝泔躅翦颡癌戾舄è沔ㄣ镱篝蝓泗汜铒铋汜飙徭弩┅篝怏篝徕戾屮翦铙轱铙沔┅篌蝈盹鲥殒灬礅溽ㄥㄨ狯瀛箦弩┅篝怏┅ㄡ蜱ㄡ徭狎珲礤铘沔┅ㄡ趑徙塍ㄡ徭狒翎汶沔┅ㄤ镬轶篌戾è睐珏铙愆┅ㄤ镬轶ㄡ狎珞躅戾篌礤礅弪螬瘐箬扉篝狒翎汶螬┅瘐箬扉篝狒翎汶螬瘐箬狎珞┅磲脲後狎珞狒翎汶螬┅ㄤ彐躅泔铙趄蹉舡溴驽铙瀛徭ㄥ狨í睐珏铙憝泔躅翦颡癌戾舄è汜铒铋汜飙後ㄣ镱篝蝓泗汜铒铋汜飙徭弩┅ㄡ蜱ㄡ徭狎珲礤铘汜铒铋汜飙後姗ㄣ铈磲磲疸狎灬礅溽ㄡ蜱戾è溴驽钿轭绛箦趔磲疸狎灬礅溽螬蝈盹鲥狎螬蝈盹鲥殒铒灬礅溽螬礤礅弪狎螬弩┅┅扉篝狎ㄩ礤礅弪铋溴驽钿轭绛箦趔铋ē犰飙趱痨弩溴驽钿轭绛箦趔┅┅狎珞┅ㄡ趑徙塍ㄡ徭狒翎汶汜铒铋汜飙後姗┅ㄤ镬轶ㄥ铘蝙泐姝磲皓ㄤ弩趄蹉趱蜷铉忾钿ㄡ蜱泐姗孱趄ㄤ镬轶ㄣ灬躞泐姗戾è睐珏铙愆┅瘐箬狎珞瘐箬扉篝狒翎汶螬瘐箬扉篝狎绌狒翎汶螬ㄤ镬轶ㄡ沆狨箦瘐箬扉篝狒翎汶螬┅┅磲脲後狎珞狒翎汶螬┅ㄤ彐躅メ祆趱痨弩篌戾蝮祜镳骘轭篌麒孱滹ㄩ铛祆蝮箦赳蝮磲疸狎＇扉篝螬箦赳蝮祜镳骘轭狃疱钿祜镳骘轭蝮泔祆邈ㄣ镱猢┅┅蝈盹鲥漉痨殂狒弩磲疸狎＇蝈盹鲥漉痨殂狒弩蝮呼弩＇箦舡羼踽飑┅换换箩箦乞犴鬻矧塍换ㄤ彐躅泔铙趄蹉舡蹁箝眇戾忉箦骝犴鬻矧ㄡ蜱螬戾è┅磲脲後扉篝狎珞ㄡ痧孱磲疸狎灬礅溽ㄡ扉篝岍狎珞扉篝扉篝┅┅┅ㄤ彐躅泔铙趄蹉舡蹁忉箦骝犴鬻矧ㄡ蜱螬磲脲後狎珞ㄡ痧孱磲疸犷灬礅溽ㄡ狨磲脲铛礅弪邃狎岍┅扉篝扉篝扉篝岍┅狎珞┅┅ㄤ彐躅泔铙趄蹉舡蹁祜镳忉箦骝犴鬻矧ㄡ蜱螬ㄡ蹒礤铘骝犴鬻矧ㄣ镱篝蝓泗祜镳徭狎珞īЖ癌┅┅ㄤ彐躅泔铙趄蹉舡麽漤箝眇戾忉箦骝犴鬻矧ㄡ蜱螬磲脲後狎珞ī┅换换田镳亮换ㄤ彐躅泔铙趄蹉舡祜镳徭ㄡ蜱狨í睐珏铙憝泔躅翦颡癌戾舄è癌ㄡ徭狎珞扉篝狎珞┅ㄡ徭狒翎汶ī┅ㄤ镬轶ㄡ狎珞戾è睐珏铙愆┅瘐箬後姝狎珞瘐箬扉篝岍後姝狒翎汶螬瘐箬扉篝博後姝狒翎汶螬瘐箬扉篝後姝狒翎汶螬┅磲脲後後姝狎珞後姝狒翎汶螬┅换换漳换ㄤ彐躅犷犰瀛弩ㄥ螬戾è狎珞躅轱瞠弩┅灬忮祗è铒瞽泔铈扉泗轭绛狎珞疳轵疳轵礤礅弪疳轵弩呼弩＇篚怏弭皓┅戾舄è泔铈扉泗轭绛狎珞蝈盹鲥殒＇铒瞽泔铈扉泗轭绛狎珞疳轵ㄡ祆疳轵狎珞┅铒瞽泔铈扉泗轭绛狎珞蝈盹鲥殒铒＇铒瞽泔铈扉泗轭绛狎珞疳轵ㄡ祆疳轵狎珞┅箦疳蜥翦洵屮趔蝈盹鲥殒灬礅溽疳轵礤礅弪ㄡ痧禊＇躅轱疳轵弩呼弩＇箦舡羼踽飑ㄡ祆疳轵弩┅箦疳蜥翦洵屮趔铒舡邃蝈盹鲥殒灬礅溽ㄥ舡疳轵ㄤ弩趄蹉趱蜷铉忾钿屮舡疳轵箫礤灬礅溽ㄡ蜱疳轵ㄤ弩趄蹉趱蜷铉忾钿ㄡ猢狎绛疳轵矧ㄡ钿礤礅弪礤礅弪┅ㄡ钿礤礅弪礤礅弪┅┅泔铈扉泗轭绛狎珞┅箦疳蜥翦洵屮趔┅扉篝恒镱骒殂糸铉狎珞泔铈扉泗轭绛狎珞侯镱泔铈扉泗轭绛狎珞铒瞽泔铈扉泗轭绛狎珞后屦狎狒邃屮趔箦疳蜥翦洵屮趔后屦狎狒邃屮趔铒舡邃箦疳蜥翦洵屮趔铒舡邃┅┅换换清铄蜷疹轳蹂禊深溴邃换ㄤ彐躅泔铙趄蹉舡珏铄蜷悱徭ㄥ狨í睐珏铙憝泔躅翦颡癌戾铄鳝狎珞铄鳝狒翎汶螬灬忮祗è磲脲狎ī戾è狎睐珏铙愆┅瘐箬狎铄鳝狎珞狎绌磲脲狒翎汶ㄡ猢瘐箬扉篝猢铄鳝狒翎汶螬┅戾舄è蹰躅轳蹂轭溟沐弩┅ㄩ钿殂弩磲疸狎＇箦泔钿蹰螬雉桢颦狎珞箦舡溟骀弪孱沐躅轱瞠弩轭溟沐螬斌ㄡ篌弪铒翎铢＇铛祆轭溟沐螬ī⑽雉躅轳蹂禊轭溴邃螈弩祜镳骘ㄡ猢轭ㄡ祆疳轵轭溟沐螬滹磲脲狒翎汶猢磲脲狒翎汶岍ㄤ镬轶ㄡ蜱雉桢颦狎珞戾è磲脲狎绌磲脲狎绌┅磲脲狒翎汶狎绌磲脲狒翎汶狎博磲脲狒翎汶暴瘐箬扉篝狎暴斌┅ㄤ镬轶ㄥ弩戾舄è轭溴箦泔钿ㄦ轭蹰弘妁＇骈蝮舂┅雉桢蝮蝈盹鲥轭溴濠┅ㄤ镬轶ㄡ蜱雉桢蝮磲脲狒翎汶轭溴箦泔钿ㄦ轭狎斌弘妁＇骈蝮舂┅┅┅磲脲後铄鳝狎珞铄鳝狒翎汶螬┅换换乞犴鬻矧蔑铙趄蹉糸镱歪泸换ㄤ彐沆狍泔铙趄īè狎珞横沣弩箫泔铙趄狎珞洪铋翎蜱横蜱螬┅ㄤ彐珏铄蜷泔铙趄蹉舡礤翳镤ㄣ镱篝脲┅ㄤ彐躅泔铙趄蹉ㄣ镱篝蝈篝狎珞戾è痨轶磲疸犷灬礅溽ㄡ蜱扉篝狎舂狎珞┅ㄡ痧禊＇泔铙趄蹉舡礤翳镤ㄩ簌礅镬泔铙趄ㄦ躅汜祆＇磲脲轭篝犷沐泔铙趄泔铙趄痨轶舂┅ㄤ彐躅泔铙趄蹉舡骝镯忾繇狃ㄣ镱篝忾繇狃ㄡ痧禊＇泔铙趄蹉泔铙趄ㄤ邈镤瀛忾繇狃泔铙趄忾繇狃┅ㄤ彐躅溴泔溴忾繇狃ㄣ镱篝忾繇狃祜镳鏖翳狎珞ㄣ镱篝颦狎珞泔铙趄骘骝镯忮祜戾铉翳狎珞麒孱祜玮轸忾繇狃泔祆邈ㄩ铘弪篝蜷铉铘狎珞┅弘妁黠蜾┅ㄤ彐磲泸溴骈铄泔铙趄蹉糸镱钺礤é蝈篝狎珞怙澌怙澌啜痱镧ㄤ彐沆狍钺礤ㄣ镱篝颟īㄤ彐礤翳镤轭轸獒扉瀛轭篝犷沐横骠弪è泔铙趄钺礤脲箦翩ㄣ镱篝颦狎珞泔铙趄К狎珞┅ㄤ彐礤翳镤泔铙趄蹉舡礤翳镤è泔铙趄钺礤脲泪蜱螬棱镤┅ㄤ彐沆狍翦篝屮痱弩箝鲩豉蜚è泔铙趄横沣弩箫翦泔铙趄洪铋翎蜱恒镱篝颟ㄢ徜横沣弩箫翦忉洪铋翩矧ī┅ㄤ彐礤翳镤轭轸獒扉瀛轭篝犷沐横骠弪è蜚翦篝屮痱弩箝鲩豉脲箦翩蜚篝狎蜚蜚孱蜚ㄥ痿戾铉翳ㄣ镱篝颦狎珞翦泔铙趄蜚┅┅┅ㄤ彐礤翳镤蜚祜镳怙澌è蜚翦篝屮痱弩箝鲩豉ㄣ桴铍蜚汨躅氅忾繇狃戾舄è後ㄣ镱篝蝓泗骝镯忾繇狃翦泔铙趄蜚忾繇狃┅蹁躅溟箴豸邃屮翦铙轱铙後姗┅ㄩ痫箝糸镱＼痱轭悱麸篝蜷铉蹁呼弩＇羼踽祓筲翳蝈徜瑚轸璀眭翦í眭翦瘐箬ㄤ邈镤瀛忾繇狃翦泔铙趄蜚忾繇狃翦忉蜚┅筲翳蝈徜瑚轸璀眭翦í眭翦躅戾篌礤礅弪蹁蜚蝈篚祠蜚弘妁＇骈蝮呼弩灬礅溽ㄡ猢箦舡羼踽呼弩＇箦舡羼踽飑┅瘐箬扉篝蹁ㄤ邈镤瀛忾繇狃翦泔铙趄蜚忾繇狃┅蜚蝈篚祠蜚┅┅┅ㄤ彐躅翦篝泔铙趄屮痱弩箝鲩豉ㄣ镱篝蝈篝狎珞躅戾篌豉疱泔铙趄с镱篝颟箦赳泔铙趄ㄡ痧禊＇磲脲轭篝犷沐泔铙趄狎珞┅戾舄è戾铉翳ㄣ镱篝颦狎珞泔铙趄┅蜚磲脲轭篝犷沐翦篝屮痱弩箝鲩豉恒镱篝泔铙趄侯蹴翳蝈徜黹趄躅汜翦博┅蝈篚祠蝓瞽蜚蜚┅鲠祯弩蝈篚祠戾铉翳蝈篚祠螬戾铉翳翦忉蜚┅麒孱翦忉蜚ㄦ轵篝翦忉蜚┅┅┅